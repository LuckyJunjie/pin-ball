[gd_scene load_steps=25 format=3 uid="uid://c5kd7lu42ufci"]

[ext_resource type="Script" uid="uid://bjmsitiu0rvq0" path="res://scripts/GameManager.gd" id="1_game_manager"]
[ext_resource type="PackedScene" uid="uid://c5ppwlxkv307j" path="res://scenes/Ball.tscn" id="2_ball_scene"]
[ext_resource type="PackedScene" uid="uid://d0513d8iwhejf" path="res://scenes/Flipper.tscn" id="3_flipper_scene"]
[ext_resource type="Script" uid="uid://utkyqs84a4qw" path="res://scripts/UI.gd" id="4_ui_script"]
[ext_resource type="PackedScene" path="res://scenes/Obstacle.tscn" id="5_obstacle_scene"]
[ext_resource type="Script" uid="uid://c4kj0nie1fi41" path="res://scripts/ObstacleSpawner.gd" id="6_obstacle_spawner"]
[ext_resource type="PackedScene" path="res://scenes/BallQueue.tscn" id="7_ball_queue_scene"]
[ext_resource type="PackedScene" uid="uid://dg5dian3ahboq" path="res://scenes/Launcher.tscn" id="8_launcher_scene"]
[ext_resource type="Texture2D" uid="uid://b2gbdkojs0e6f" path="res://assets/sprites/wall.png" id="10_wall_texture"]
[ext_resource type="Texture2D" uid="uid://iusi8c5f0e7k" path="res://assets/sprites/background.png" id="11_background_texture"]
[ext_resource type="PackedScene" path="res://scenes/Hold.tscn" id="12_hold_scene"]
[ext_resource type="Script" uid="uid://xpynup2qppu3" path="res://scripts/SoundManager.gd" id="13_sound_manager"]
[ext_resource type="Script" uid="uid://ba5uv3udu01gs" path="res://scripts/Ramp.gd" id="14_ramp_script"]
[ext_resource type="Script" path="res://scripts/MazePipeManager.gd" id="15_maze_pipe_manager"]
[ext_resource type="TileSet" path="res://assets/tilesets/pipe_maze_tileset.tres" id="16_tileset"]

[sub_resource type="PhysicsMaterial" id="PhysicsMaterial_wall"]
friction = 0.3
bounce = 0.7

[sub_resource type="RectangleShape2D" id="RectangleShape2D_wall_top"]
size = Vector2(800, 20)

[sub_resource type="RectangleShape2D" id="RectangleShape2D_wall_left"]
size = Vector2(20, 600)

[sub_resource type="RectangleShape2D" id="RectangleShape2D_wall_right"]
size = Vector2(20, 600)

[sub_resource type="RectangleShape2D" id="RectangleShape2D_wall_bottom_left"]
size = Vector2(350, 20)

[sub_resource type="RectangleShape2D" id="RectangleShape2D_wall_bottom_right"]
size = Vector2(350, 20)

[sub_resource type="RectangleShape2D" id="RectangleShape2D_ramp_long"]
size = Vector2(300, 20)

[sub_resource type="RectangleShape2D" id="RectangleShape2D_ramp"]
size = Vector2(253.99286, 20)

[sub_resource type="PhysicsMaterial" id="PhysicsMaterial_pipe"]
friction = 0.1
bounce = 0.3

[sub_resource type="RectangleShape2D" id="RectangleShape2D_pipe_vertical"]
size = Vector2(5, 300)

[sub_resource type="RectangleShape2D" id="RectangleShape2D_pipe_back"]
size = Vector2(35, 3)

[node name="Main" type="Node2D"]

[node name="Camera2D" type="Camera2D" parent="."]
position = Vector2(400, 300)

[node name="GameManager" type="Node2D" parent="."]
script = ExtResource("1_game_manager")
ball_scene = ExtResource("2_ball_scene")
ball_spawn_position = Vector2(400, 550)
launch_force = Vector2(0, -600)

[node name="SoundManager" type="Node" parent="."]
script = ExtResource("13_sound_manager")

[node name="Playfield" type="Node2D" parent="."]
z_index = -1

[node name="Background" type="Sprite2D" parent="Playfield"]
modulate = Color(1, 1, 1, 0.8)
position = Vector2(-1, 0)
texture = ExtResource("11_background_texture")
offset = Vector2(400, 300)

[node name="Walls" type="Node2D" parent="Playfield"]

[node name="WallTop" type="StaticBody2D" parent="Playfield/Walls"]
collision_layer = 4
collision_mask = 0
physics_material_override = SubResource("PhysicsMaterial_wall")

[node name="CollisionShape2D" type="CollisionShape2D" parent="Playfield/Walls/WallTop"]
position = Vector2(400, 10)
shape = SubResource("RectangleShape2D_wall_top")

[node name="Visual" type="Sprite2D" parent="Playfield/Walls/WallTop"]
scale = Vector2(40, 1)
texture = ExtResource("10_wall_texture")
offset = Vector2(400, 10)

[node name="ColorRectFallback" type="ColorRect" parent="Playfield/Walls/WallTop"]
offset_top = -10.0
offset_right = 800.0
offset_bottom = 10.0
color = Color(0.3, 0.3, 0.4, 1)

[node name="WallLeft" type="StaticBody2D" parent="Playfield/Walls"]
collision_layer = 4
collision_mask = 0
physics_material_override = SubResource("PhysicsMaterial_wall")

[node name="CollisionShape2D" type="CollisionShape2D" parent="Playfield/Walls/WallLeft"]
position = Vector2(10, 300)
shape = SubResource("RectangleShape2D_wall_left")

[node name="Visual" type="Sprite2D" parent="Playfield/Walls/WallLeft"]
scale = Vector2(1, 30)
texture = ExtResource("10_wall_texture")
offset = Vector2(10, 300)

[node name="ColorRectFallback" type="ColorRect" parent="Playfield/Walls/WallLeft"]
offset_top = -300.0
offset_right = 20.0
offset_bottom = 300.0
color = Color(0.3, 0.3, 0.4, 1)

[node name="WallRight" type="StaticBody2D" parent="Playfield/Walls"]
collision_layer = 4
collision_mask = 0
physics_material_override = SubResource("PhysicsMaterial_wall")

[node name="CollisionShape2D" type="CollisionShape2D" parent="Playfield/Walls/WallRight"]
position = Vector2(790, 300)
shape = SubResource("RectangleShape2D_wall_right")

[node name="Visual" type="Sprite2D" parent="Playfield/Walls/WallRight"]
scale = Vector2(1, 30)
texture = ExtResource("10_wall_texture")
offset = Vector2(790, 300)

[node name="ColorRectFallback" type="ColorRect" parent="Playfield/Walls/WallRight"]
offset_left = 780.0
offset_top = -300.0
offset_right = 800.0
offset_bottom = 300.0
color = Color(0.3, 0.3, 0.4, 1)

[node name="WallBottomLeft" type="StaticBody2D" parent="Playfield/Walls"]
collision_layer = 4
collision_mask = 0
physics_material_override = SubResource("PhysicsMaterial_wall")

[node name="CollisionShape2D" type="CollisionShape2D" parent="Playfield/Walls/WallBottomLeft"]
position = Vector2(175, 590)
shape = SubResource("RectangleShape2D_wall_bottom_left")

[node name="Visual" type="Sprite2D" parent="Playfield/Walls/WallBottomLeft"]
scale = Vector2(17.5, 1)
texture = ExtResource("10_wall_texture")
offset = Vector2(175, 590)

[node name="ColorRectFallback" type="ColorRect" parent="Playfield/Walls/WallBottomLeft"]
offset_top = 580.0
offset_right = 350.0
offset_bottom = 600.0
color = Color(0.3, 0.3, 0.4, 1)

[node name="WallBottomRight" type="StaticBody2D" parent="Playfield/Walls"]
collision_layer = 4
collision_mask = 0
physics_material_override = SubResource("PhysicsMaterial_wall")

[node name="CollisionShape2D" type="CollisionShape2D" parent="Playfield/Walls/WallBottomRight"]
position = Vector2(625, 590)
shape = SubResource("RectangleShape2D_wall_bottom_right")

[node name="Visual" type="Sprite2D" parent="Playfield/Walls/WallBottomRight"]
scale = Vector2(17.5, 1)
texture = ExtResource("10_wall_texture")
offset = Vector2(625, 590)

[node name="ColorRectFallback" type="ColorRect" parent="Playfield/Walls/WallBottomRight"]
offset_left = 450.0
offset_top = 580.0
offset_right = 800.0
offset_bottom = 600.0
color = Color(0.3, 0.3, 0.4, 1)

[node name="Ramps" type="Node2D" parent="Playfield"]

[node name="RampLeftCurved" type="StaticBody2D" parent="Playfield/Ramps"]
position = Vector2(150, 500)
rotation = 0.785398
collision_layer = 4
collision_mask = 0

[node name="CollisionShape2D" type="CollisionShape2D" parent="Playfield/Ramps/RampLeftCurved"]
position = Vector2(-2.121314, -31.819805)
rotation = -0.20943952
shape = SubResource("RectangleShape2D_ramp_long")

[node name="Visual" type="ColorRect" parent="Playfield/Ramps/RampLeftCurved"]
offset_left = -150.0
offset_top = -10.358795
offset_right = 149.80124
offset_bottom = 10.0
rotation = -0.20943952
color = Color(0.6, 0.4, 0.2, 1)

[node name="RampLeftTop" type="StaticBody2D" parent="Playfield/Ramps"]
position = Vector2(100, 200)
rotation = -0.523599
collision_layer = 4
collision_mask = 0

[node name="CollisionShape2D" type="CollisionShape2D" parent="Playfield/Ramps/RampLeftTop"]
shape = SubResource("RectangleShape2D_ramp")

[node name="Visual" type="ColorRect" parent="Playfield/Ramps/RampLeftTop"]
offset_left = -75.0
offset_top = -10.0
offset_right = 75.0
offset_bottom = 10.0
color = Color(0.6, 0.4, 0.2, 1)

[node name="RampLuncherBottom" type="StaticBody2D" parent="Playfield/Ramps"]
position = Vector2(720, 400)
collision_layer = 4
collision_mask = 0
script = ExtResource("14_ramp_script")
ramp_length = 350.0
ramp_angle = 30.0
ramp_width = 60.0
curve_points = 20

[node name="RampLuncherUp" type="StaticBody2D" parent="Playfield/Ramps"]
position = Vector2(450, 250)
collision_layer = 4
collision_mask = 0
script = ExtResource("14_ramp_script")
ramp_length = 280.0
ramp_angle = 40.0
ramp_width = 60.0
curve_points = 20

[node name="RampBottomRight" type="StaticBody2D" parent="Playfield/Ramps"]
position = Vector2(600, 520)
rotation = -0.261799
collision_layer = 4
collision_mask = 0

[node name="CollisionShape2D" type="CollisionShape2D" parent="Playfield/Ramps/RampBottomRight"]
shape = SubResource("RectangleShape2D_ramp")

[node name="Visual" type="ColorRect" parent="Playfield/Ramps/RampBottomRight"]
offset_left = -117.90088
offset_top = -10.0
offset_right = 175.73462
offset_bottom = 10.0
color = Color(0.6, 0.4, 0.2, 1)

[node name="ObstacleSpawner" type="Node2D" parent="Playfield"]
script = ExtResource("6_obstacle_spawner")
obstacle_scene = ExtResource("5_obstacle_scene")

[node name="Holds" type="Node2D" parent="Playfield"]

[node name="Hold1" parent="Playfield/Holds" instance=ExtResource("12_hold_scene")]
position = Vector2(400, 280)

[node name="Hold2" parent="Playfield/Holds" instance=ExtResource("12_hold_scene")]
position = Vector2(550, 180)
points_value = 15

[node name="Hold3" parent="Playfield/Holds" instance=ExtResource("12_hold_scene")]
position = Vector2(250, 120)
points_value = 20

[node name="Hold4" parent="Playfield/Holds" instance=ExtResource("12_hold_scene")]
position = Vector2(100, 200)
points_value = 25

[node name="Hold5" parent="Playfield/Holds" instance=ExtResource("12_hold_scene")]
position = Vector2(680, 120)
points_value = 30

[node name="BallQueue" parent="." instance=ExtResource("7_ball_queue_scene")]
z_index = 1
ball_scene = ExtResource("2_ball_scene")

[node name="PipeGuide" type="Node2D" parent="."]

[node name="MazePipe" type="TileMapLayer" parent="PipeGuide"]
tile_set = ExtResource("16_tileset")
script = ExtResource("15_maze_pipe_manager")
default_maze_layout = "level_1"
tile_size = 32

[node name="PipeBack" type="StaticBody2D" parent="PipeGuide"]
position = Vector2(720, 105)
collision_layer = 0
collision_mask = 0

[node name="CollisionShape2D" type="CollisionShape2D" parent="PipeGuide/PipeBack"]
shape = SubResource("RectangleShape2D_pipe_back")

[node name="Visual" type="ColorRect" parent="PipeGuide/PipeBack"]
offset_left = -17.5
offset_top = -1.5
offset_right = 17.5
offset_bottom = 1.5
color = Color(0.5, 0.4, 0.3, 1)

[node name="Launcher" parent="." instance=ExtResource("8_launcher_scene")]
z_index = 1
position = Vector2(720, 400)

[node name="Flippers" type="Node2D" parent="."]

[node name="FlipperLeft" parent="Flippers" instance=ExtResource("3_flipper_scene")]
position = Vector2(370, 480)
rest_angle = 30.0
pressed_angle = -10.0

[node name="FlipperRight" parent="Flippers" instance=ExtResource("3_flipper_scene")]
position = Vector2(430, 480)
flipper_side = "right"
rest_angle = -30.0
pressed_angle = 10.0

[node name="UI" type="CanvasLayer" parent="."]
script = ExtResource("4_ui_script")

[node name="ScoreLabel" type="Label" parent="UI"]
offset_left = 20.0
offset_top = 20.0
offset_right = 200.0
offset_bottom = 60.0
theme_override_colors/font_color = Color(1, 1, 1, 1)
theme_override_font_sizes/font_size = 32
text = "Score: 0"

[node name="Instructions" type="Label" parent="UI"]
offset_left = 20.0
offset_top = 70.0
offset_right = 400.0
offset_bottom = 150.0
theme_override_colors/font_color = Color(0.9, 0.9, 0.9, 1)
theme_override_font_sizes/font_size = 16
text = "Left/A: Left Flipper
Right/D: Right Flipper
Hold Space/Down: Charge Launcher
Esc: Pause"

[node name="CurrencyDisplay" type="HBoxContainer" parent="UI"]
offset_left = 580.0
offset_top = 20.0
offset_right = 780.0
offset_bottom = 80.0
visible = false

[node name="CoinLabel" type="Label" parent="UI/CurrencyDisplay"]
layout_mode = 2
theme_override_colors/font_color = Color(1, 0.84, 0, 1)
theme_override_font_sizes/font_size = 20
text = "Coins: 0"

[node name="GemLabel" type="Label" parent="UI/CurrencyDisplay"]
layout_mode = 2
theme_override_colors/font_color = Color(0.6, 0.4, 1, 1)
theme_override_font_sizes/font_size = 20
text = "Gems: 0"

[node name="BackToMenuButton" type="Button" parent="UI"]
offset_left = 20.0
offset_top = 550.0
offset_right = 150.0
offset_bottom = 590.0
text = "‚Üê Back to Menu"

[node name="Visual" type="ColorRect" parent="."]
offset_left = 249.16058
offset_top = -430.14417
offset_right = 426.89307
offset_bottom = -410.14417
color = Color(0.6, 0.4, 0.2, 1)

[connection signal="score_changed" from="GameManager" to="UI" method="set_score_text"]
