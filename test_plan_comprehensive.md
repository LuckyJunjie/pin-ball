# 🎮 游戏测试计划 - 全面测试用例

**版本:** 1.0  
**创建时间:** 2026-02-20  
**目标:** pin-ball 和 PI-PinBall 项目全面测试  
**测试框架:** GdUnit4 + GDSnap (待实现)

---

## 📋 测试策略

### 测试金字塔
```
         /\
        /  \      E2E 测试 (端到端)
       /____\     截图验证、完整流程
      /      \
     /        \   集成测试 (模块交互)
    /__________\  场景测试、功能组合
   /            \
  /              \ 单元测试 (核心逻辑)
 /________________\ 函数测试、断言
```

### 测试优先级
| 级别 | 优先级 | 测试类型 |
|------|--------|----------|
| P0 | 最高 | 核心功能 (发射/挡板/得分) |
| P1 | 高 | 重要功能 (角色/关卡/UI) |
| P2 | 中 | 扩展功能 (特效/音效/统计) |
| P3 | 低 | 边缘情况 (异常处理) |

---

## 🎯 测试用例矩阵

### A. 核心游戏机制 (P0 - 必须通过)

#### A1. 发射机制
| ID | 用例 | 步骤 | 预期结果 | 截图 |
|----|------|------|----------|------|
| A1-01 | 蓄力发射 | 1.按住发射键<br>2.观察蓄力条<br>3.松开发射 | 球以蓄力值速度发射 | ✅ |
| A1-02 | 轻发射 | 按住<1秒松手 | 球低速发射 | ✅ |
| A1-03 | 重发射 | 按住>2秒松手 | 球高速发射 | ✅ |
| A1-04 | 发射位置 | 观察发射后球位置 | 球从发射区出发 | ✅ |

#### A2. 挡板控制
| ID | 用例 | 步骤 | 预期结果 | 截图 |
|----|------|------|----------|------|
| A2-01 | 左挡板 | 按左方向键 | 左挡板向上旋转 | ✅ |
| A2-02 | 右挡板 | 按右方向键 | 右挡板向上旋转 | ✅ |
| A2-03 | 双挡板 | 同时按左右键 | 两挡板同时动作 | ✅ |
| A2-04 | 挡板碰撞 | 球撞击上升挡板 | 球反弹方向正确 | ✅ |

#### A3. 得分系统
| ID | 用例 | 步骤 | 预期结果 | 截图 |
|----|------|------|----------|------|
| A3-01 | 碰撞得分 | 球碰得分区 | 分数增加 | ✅ |
| A3-02 | 得分动画 | 得分时 | 显示得分 popup | ✅ |
| A3-03 | 连续得分 | 快速多次碰得分区 | 分数累加 | ✅ |
| A3-04 | 得分显示 | 观察 HUD | 正确显示当前分数 | ✅ |

#### A4. 游戏流程
| ID | 用例 | 步骤 | 预期结果 | 截图 |
|----|------|------|----------|------|
| A4-01 | 游戏开始 | 点击开始游戏 | 游戏界面显示 | ✅ |
| A4-02 | 球掉落 | 球落到底部 | 生命-1 | ✅ |
| A4-03 | 游戏结束 | 生命=0时 | 显示结束界面 | ✅ |
| A4-04 | 重新开始 | 结束界面点重玩 | 回到初始状态 | ✅ |

---

### B. 角色系统 (P1)

#### B1. 角色选择
| ID | 用例 | 步骤 | 预期结果 | 截图 |
|----|------|------|----------|------|
| B1-01 | 打开选择 | 主菜单选角色 | 显示角色列表 | ✅ |
| B1-02 | 选择角色 | 点击某角色 | 角色被选中 | ✅ |
| B1-03 | 角色描述 | 悬停角色 | 显示角色说明 | ✅ |
| B1-04 | 确认角色 | 选好后点确认 | 角色生效 | ✅ |

#### B2. 角色能力
| ID | 用例 | 步骤 | 预期结果 | 截图 |
|----|------|------|----------|------|
| B2-01 | 得分倍率 | 用幸运儿游戏 | 得分x1.2 | ✅ |
| B2-02 | 速度提升 | 用闪电侠游戏 | 球速提升 | ✅ |
| B2-03 | 磁铁效果 | 用磁铁人游戏 | 球被吸附 | ✅ |
| B2-04 | 额外生命 | 用守护者游戏 | 生命+1 | ✅ |

---

### C. 关卡系统 (P1)

#### C1. 关卡选择
| ID | 用例 | 步骤 | 预期结果 | 截图 |
|----|------|------|----------|------|
| C1-01 | 打开关卡 | 主菜单选关卡 | 显示关卡列表 | ✅ |
| C1-02 | 选择关卡 | 点击某关卡 | 选中高亮 | ✅ |
| C1-03 | 关卡难度 | 查看关卡信息 | 显示难度星级 | ✅ |

#### C2. 关卡切换
| ID | 用例 | 步骤 | 预期结果 | 截图 |
|----|------|------|----------|------|
| C2-01 | 通过关卡 | 达成过关条件 | 切换下一关 | ✅ |
| C2-02 | 主题变化 | 进入不同关卡 | 背景/障碍变化 | ✅ |
| C2-03 | 最后一关 | 通过后 | 显示通关画面 | ✅ |

---

### D. UI系统 (P1)

#### D1. 主菜单
| ID | 用例 | 步骤 | 预期结果 | 截图 |
|----|------|------|----------|------|
| D1-01 | 菜单显示 | 打开游戏 | 主菜单正确显示 | ✅ |
| D1-02 | 按钮响应 | 点击各按钮 | 正确跳转 | ✅ |
| D1-03 | 菜单动画 | 观察菜单 | 动画流畅 | ✅ |

#### D2. 设置
| ID | 用例 | 步骤 | 预期结果 | 截图 |
|----|------|------|----------|------|
| D2-01 | 音量调节 | 拖动滑块 | 音量变化 | ✅ |
| D2-02 | 分辨率 | 切换分辨率 | 画面适应 | ✅ |
| D2-03 | 保存设置 | 修改后退出 | 设置保存 | ✅ |

#### D3. 暂停
| ID | 用例 | 步骤 | 预期结果 | 截图 |
|----|------|------|----------|------|
| D3-01 | 暂停游戏 | 按ESC | 暂停菜单显示 | ✅ |
| D3-02 | 继续游戏 | 点继续 | 游戏继续 | ✅ |
| D3-03 | 暂停时音乐 | 暂停状态 | 音乐停止 | ✅ |

---

### E. 扩展功能 (P2)

#### E1. 排行榜
| ID | 用例 | 步骤 | 预期结果 | 截图 |
|----|------|------|----------|------|
| E1-01 | 查看排行 | 主菜单点排行 | 显示排名列表 | ✅ |
| E1-02 | 上榜条件 | 达到分数 | 记录被保存 | ✅ |

#### E2. 成就系统
| ID | 用例 | 步骤 | 预期结果 | 截图 |
|----|------|------|----------|------|
| E2-01 | 成就入口 | 主菜单点成就 | 显示成就列表 | ✅ |
| E2-02 | 获得成就 | 达成条件 | 成就解锁提示 | ✅ |

#### E3. 每日挑战
| ID | 用例 | 步骤 | 预期结果 | 截图 |
|----|------|------|----------|------|
| E3-01 | 挑战显示 | 点每日挑战 | 显示今日任务 | ✅ |
| E3-02 | 任务进度 | 进行游戏 | 进度更新 | ✅ |

---

### F. 音效与特效 (P2)

#### F1. 音效
| ID | 用例 | 步骤 | 预期结果 | 截图 |
|----|------|------|----------|------|
| F1-01 | 发射音效 | 发射球 | 发射音效播放 | ❌ |
| F1-02 | 碰撞音效 | 球碰障碍 | 碰撞音效播放 | ❌ |
| F1-03 | 得分音效 | 得分时 | 得分音效播放 | ❌ |
| F1-04 | BGM | 游戏中 | 背景音乐播放 | ❌ |

#### F2. 视觉特效
| ID | 用例 | 步骤 | 预期结果 | 截图 |
|----|------|------|----------|------|
| F2-01 | 得分特效 | 得分时 | 特效动画显示 | ✅ |
| F2-02 | 碰撞特效 | 球碰障碍 | 火花/闪光 | ✅ |

---

### G. 边缘情况 (P3)

| ID | 用例 | 步骤 | 预期结果 |
|----|------|------|----------|
| G1-01 | 快速连续按键 | 极快按键 | 无异常 |
| G1-02 | 窗口失焦 | 游戏时最小化 | 暂停/继续正常 |
| G1-03 | 网络异常 | 离线模式 | 游戏正常 |
| G1-04 | 存档损坏 | 模拟损坏 | 给出默认值 |

---

## 📊 测试覆盖率目标

### 按功能
| 模块 | 目标覆盖率 | 当前状态 |
|------|------------|----------|
| 发射机制 | 100% | ⏳ |
| 挡板控制 | 100% | ⏳ |
| 得分系统 | 100% | ⏳ |
| 角色系统 | 80% | ⏳ |
| 关卡系统 | 80% | ⏳ |
| UI系统 | 70% | ⏳ |
| 音效 | 60% | ⏳ |

### 按优先级
| 优先级 | 测试用例数 | 目标通过率 |
|--------|------------|------------|
| P0 | 15 | 100% |
| P1 | 25 | 90% |
| P2 | 15 | 80% |
| P3 | 5 | 60% |

---

## 🔧 测试环境

### 本地测试 (CodeForge)
```
Godot 4.x
├── 项目: pin-ball / PI-PinBall
├── 工具: GdUnit4, GDSnap
└── 运行: 本地 Godot
```

### CI/CD 测试 (Vanguard001)
```
GitHub Actions
├── Godot Headless
├── 自动化测试
└── 截图验证
```

---

## 📝 测试执行流程

### 1. 准备阶段
```
□ 检查 Godot 环境
□ 确认测试用例列表
□ 准备基准截图
```

### 2. 执行阶段
```
□ 按优先级执行测试
□ 记录实际结果
□ 截图对比
```

### 3. 验收阶段
```
□ 对比预期 vs 实际
□ 标记通过/失败
□ 分析失败原因
```

### 4. 报告阶段
```
□ 生成测试报告
□ 更新测试用例状态
□ 制定修复计划
```

---

## ✅ 测试检查清单

### 功能检查
- [ ] 发射机制正常工作
- [ ] 挡板控制响应正确
- [ ] 得分系统准确
- [ ] 游戏流程完整

### 性能检查
- [ ] 帧率稳定 (>30fps)
- [ ] 无内存泄漏
- [ ] 加载时间合理

### 兼容性检查
- [ ] 不同分辨率正常
- [ ] 窗口/全屏正常

---

*测试计划由 Vanguard001 创建 - 供 CodeForge 执行验证*
